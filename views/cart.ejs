<!DOCTYPE html>
<html lang="en">

<head>
   <!-- basic -->
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <!-- mobile metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="initial-scale=1, maximum-scale=1">
   <!-- site metas -->
   <title>Cart</title>
   <meta name="keywords" content="">
   <meta name="description" content="">
   <meta name="author" content="">
   <!-- bootstrap css -->
   <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
   <!-- style css -->
   <link rel="stylesheet" type="text/css" href="css/style.css">
   <!-- Responsive-->
   <link rel="stylesheet" href="css/responsive.css">
   <!-- fevicon -->
   <link rel="icon" href="images/fevicon.png" type="image/gif" />
   <!-- Scrollbar Custom CSS -->
   <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
   <!-- Tweaks for older IEs-->
   <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
   <!-- fonts -->
   <link href="https://fonts.googleapis.com/css?family=Great+Vibes|Open+Sans:400,700&display=swap&subset=latin-ext"
      rel="stylesheet">
   <!-- owl stylesheets -->
   <link rel="stylesheet" href="css/owl.carousel.min.css">
   <link rel="stylesheet" href="css/owl.theme.default.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css"
      media="screen">
   <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
   <link rel="stylesheet" href="./css/cart.css">
</head>

<body>
   <!-- header section start -->
   <div class="header_section">
      <div class="container-fluid">
         <nav class="navbar navbar-light bg-light justify-content-between">
            <div id="mySidenav" class="sidenav">
               <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
               <a href="http://localhost:3000/home">Home</a>
               <a href="http://localhost:3000/products">Our Products</a>
               <a href="http://localhost:3000/products?category=makeup">Make-Up</a>
               <a href="http://localhost:3000/products?category=skincare">Skin-Care</a>
               <a href="http://localhost:3000/about">About</a>
               <a href="http://localhost:3000/contact">Contact</a>
            </div>
            <span class="toggle_icon" onclick="openNav()"><img src="images/toggle-icon.png"></span>
            <div class="logo"><img src="images/glamsphere.png"></div>
            <div class="form-inline ">
               <div class="login_text">
                  <ul>
                     <li>
                        <form id="profileForm" method="POST" action="http://localhost:3000/profile">
                           <input type="number" id="usernameP" name="username" style="display: none;">
                           <button class="user-img"><img src="images/user-icon.png"></button>
                        </form>
                     </li>
                     <li>
                        <form id="cartForm" method="POST" action="http://localhost:3000/cart">
                           <input type="number" id="username" name="username" style="display: none;">
                           <button class="bag-icon"><img src="images/bag-icon.png"></button>
                        </form>
                     </li>
                  </ul>
               </div>
         </nav>
      </div>
   </div>
   <!-- header section end -->

   <!-- product section start -->
   <section class="cart_section layout_padding">
      <div class="container">
         <h2>Your Shopping Cart</h2>
         <% if (cartItems.length==0) { %>
            <h2>NO ITEMS IN CART !! Shop <a href="http://localhost:3000/products">here</a></h2>
            <% } else { %>
               <table class="cart-table">
                  <thead>
                     <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr>
                        <% for (let item of cartItems) { %>
                     <tr>
                        <td>
                           <div class="cart-info">
                              <a href="http://localhost:3000/products/<%= item.productid %>"><img class="cart-image"
                                    src="<%= item.imagePath %>"></a>
                              <div class="cart-details">
                                 <a href="http://localhost:3000/products/<%= item.productid %>">
                                    <p class="cart-title">
                                       <%= item.PName %>
                                    </p>
                                 </a>
                                 <span class="cart-price">
                                    <%= item.Price %>
                                 </span>

                              </div>
                           </div>
                        </td>
                        <td>
                           <%= item.quantity %>
                        </td>
                        <td>
                           <%= item.Price * item.quantity %>
                        </td>
                        <% } %>


                     </tr>
                     </tr>
                  </tbody>
                  <tfoot class="lastline">
                     <tr>
                        <td>Total</td>
                        <td id="total_items">
                           <%= totalDetail.totalItems %>
                        </td>
                        <td id="total">
                           <%= totalDetail.total %>
                        </td>
                     </tr>
                  </tfoot>
               </table>
               <div class="checkout-section">
                  <div class="btn"><a href="http://localhost:3000/home">Continue Shopping</a></div>
                  <div class="btn"><button onclick="checkout()">Checkout</button></div>
               </div>
               <% } %>


      </div>
   </section>
   <!-- customer section end -->

   <!-- footer section start -->
   <div class="footer_section layout_padding">
      <div class="container">
         <div class="footer_logo"><a href="http://localhost:3000/home"><img src="images/image.png"></a></div>
         <div class="contact_section_2">
            <div class="row">
               <div class="col-sm-4">
                  <h3 class="address_text">Contact Us</h3>
                  <div class="address_bt">
                     <ul>
                        <li>
                           <a href="https://maps.app.goo.gl/RnGmpCqyCNPFZxDH7">
                              <i class="fa fa-map-marker" aria-hidden="true"></i><span class="padding_left10">Address :
                                 Forum Mall, South Bangalore </span>
                           </a>
                        </li>
                        <li>
                           <a href="tel:9470806786">
                              <i class="fa fa-phone" aria-hidden="true"></i><span class="padding_left10">Call :
                                 9844420212, 9470806786</span>
                           </a>
                        </li>
                        <li>
                           <a href="mailto:fatima.amani65@gmail.com">
                              <i class="fa fa-envelope" aria-hidden="true"></i><span class="padding_left10">Email :
                                 contactus@glamsphere.in</span>
                           </a>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="col-sm-4">
                  <div class="footer_logo_1"><a href="http://localhost:3000/home"><img src="./images/image.png"></a>
                  </div>
                  <p class="dummy_text">Your go-to hub for all things beauty.</p>
               </div>
               <div class="col-sm-4">
                  <div class="main">
                     <h3 class="address_text">Best Products</h3>
                     <p class="ipsum_text">Sunscreen <br>Lipsticks <br>Lip Balm <br> Eye Shadow </p>
                  </div>
               </div>
            </div>
         </div>
         <div class="social_icon">
            <ul>
               <li>
                  <a href="https://www.facebook.com/"><i class="fa fa-facebook" aria-hidden="true"></i></a>
               </li>
               <li>
                  <a href="https://twitter.com/"><i class="fa fa-twitter" aria-hidden="true"></i></a>
               </li>
               <li>
                  <a href="https://www.youtube.com/@fatimadoesthemakeup"><i class="fa fa-youtube"
                        aria-hidden="true"></i></a>
               </li>
               <li>
                  <a href="https://www.instagram.com/fatimadoesthemakeup/"><i class="fa fa-instagram"
                        aria-hidden="true"></i></a>
               </li>
            </ul>
         </div>
      </div>
   </div>
   <!-- footer section end -->
   <!-- copyright section start -->
   <div class="copyright_section">
      <div class="container">
         <p class="copyright_text">&#169; 2024 All Rights Reserved. <a href="https://html.design"></a></p>
      </div>
   </div>
   <!-- copyright section end -->
   <!-- Javascript files-->
   <script src="js/jquery.min.js"></script>
   <script src="js/popper.min.js"></script>
   <script src="js/bootstrap.bundle.min.js"></script>
   <script src="js/jquery-3.0.0.min.js"></script>
   <script src="js/plugin.js"></script>
   <!-- sidebar -->
   <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
   <script src="js/custom.js"></script>
   <!-- javascript -->
   <script src="js/owl.carousel.js"></script>
   <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
   <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
   <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
   <script>
      function openNav() {
         document.getElementById("mySidenav").style.width = "100%";
      }

      function closeNav() {
         document.getElementById("mySidenav").style.width = "0";
      }

      document.addEventListener('DOMContentLoaded', function () {
         var usernameInput = document.getElementById('username');
         if (usernameInput) {
            var userID = parseInt(localStorage.getItem("UserID"));
            if (!isNaN(userID)) {
               usernameInput.value = userID;
            }
         }
      });

      document.addEventListener('DOMContentLoaded', function () {
         var usernameInput = document.getElementById('usernameP');
         if (usernameInput) {
            var userID = parseInt(localStorage.getItem("UserID"));
            if (!isNaN(userID)) {
               usernameInput.value = userID;
            }
         }
      });



      function checkout() {
         const url = "http://localhost:3000/checkout";
         let userid = parseInt(localStorage.getItem("UserID"));

         const queryString = `userid=${userid}`;

         // Create the full URL with the query string
         const fullUrl = `${url}?${queryString}`;

         // Send the GET request
         fetch(fullUrl)
            .then(response => {
               if (!response.ok) {
                  throw new Error('Network response was not ok');
               }
               return response.json(); // Assuming the response is JSON
            })
            .then(data => {
               if (data.success == true) {

                  let myOrder = data.myOrder;


                  var options = {
                     "key": "rzp_test_ztvlLbwUAdGqVu",
                     "amount": myOrder.amount.toString(),
                     "currency": "INR",
                     "name": "GlamSphere",
                     "description": "Pay & Checkout your Favourite Beauty Products !!",
                     "image": "data:image/jpeg;base64,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",
                     "order_id": myOrder.id,
                     "handler": function (response2) {
                        console.log(response2);
                        alert("This step of Payment Succeeded");
                        success(response2, myOrder.receipt);
                     },
                     "prefill": {
                        "contact": localStorage.getItem('Phone').toString(),
                        // Name and email ID for checkout
                        "name": localStorage.getItem('FirstName'),
                        "email": localStorage.getItem('EmailID')

                     },
                     "notes": myOrder.notes,
                     "theme": {
                        "color": "#2300a3"
                     }
                  };
                  var razorpayObject = new Razorpay(options);
                  console.log(razorpayObject);
                  razorpayObject.on('payment.failed', function (response) {
                     console.log(response);
                     if (response.error.reason == "payment_failed") {
                        alert("This step of Payment Failed");
                        failure(response, myOrder.receipt);
                        window.location.href = "http://localhost:3000/orderfailed";
                     }
                  });

                  razorpayObject.open();


               }
            })
            .catch(error => {
               // Handle errors
               console.error('There was a problem with the fetch operation:', error);
            });
      }


      function success(response, oid) {
         console.log("inside success");

         const url = 'http://localhost:3000/verifyOrder';

         // Request body data 
         const requestBody = {
            'order_id': response['razorpay_order_id'],
            'payment_id': response['razorpay_payment_id'],
            'OrderID': oid

         };

         // Request headers
         const headers = {
            'Content-Type': 'application/json',
            "x-razorpay-signature": response.razorpay_signature
         };

         // Fetch options
         const options = {
            method: 'POST',
            headers: headers,
            body: JSON.stringify(requestBody)
         };

         // Making the POST request
         fetch(url, options)
            .then(response => {
               if (!response.ok) {
                  throw new Error('Request failed with status ' + response.status);
               }
               return response.json();
            })
            .then(data => {
               if (data.success == true) {
                  console.log("inside payment good")
                  window.location.href = "http://localhost:3000/orderplaced";
               } else {
                  alert('payment verification failed');
               }
            })
            .catch(error => {
               console.error('Error:', error);
               alert('Payment Failed, please try again later');
               setTimeout(() => {
                  window.location.href = "http://localhost:3000/home";
               }, 3000);

            });

      }

      function failure(response, Order_id) {
         // URL to which the POST request will be sent
         const url = 'http://localhost:3000/cancelOrder';

         // Request body data (assuming it's JSON)
         const requestBody = {
            OrderID: Order_id,
         };


         const options = {
            method: 'POST',
            headers: {
               'Content-Type': 'application/json',
            },
            body: JSON.stringify(requestBody)
         };

         fetch(url, options)
            .then(response => {
               if (!response.ok) {
                  throw new Error('Request failed with status ' + response.status);
               }
            })
            .then(data => {
               if (data.success == true) {

               }

            })
            .catch(error => {
               console.error('Error:', error);
               alert = 'Some error occured, plese try again later';

            });

      }



   </script>
</body>

</html>